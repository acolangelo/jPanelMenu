/**
  *
  * jPanelMenu 1.3.0 (http://jpanelmenu.com)
  * By Anthony Colangelo (http://acolangelo.com)
  *
* */
(function($){$.jPanelMenu=function(h){if(typeof(h)=="undefined"||h==null){h={}};var i={options:$.extend({menu:'#menu',trigger:'.menu-trigger',excludedPanelContent:'style, script',direction:'left',openPosition:'250px',animated:true,closeOnContentClick:true,keyboardShortcuts:[{code:27,open:false,close:true},{code:37,open:false,close:true},{code:39,open:true,close:true},{code:77,open:true,close:true}],duration:150,openDuration:h.duration||150,closeDuration:h.duration||150,easing:'ease-in-out',openEasing:h.easing||'ease-in-out',closeEasing:h.easing||'ease-in-out',before:function(){},beforeOpen:function(){},beforeClose:function(){},after:function(){},afterOpen:function(){},afterClose:function(){},beforeOn:function(){},afterOn:function(){},beforeOff:function(){},afterOff:function(){}},h),settings:{transitionsSupported:'WebkitTransition'in document.body.style||'MozTransition'in document.body.style||'msTransition'in document.body.style||'OTransition'in document.body.style||'Transition'in document.body.style,shiftFixedChildren:false,panelPosition:'relative',positionUnits:'px'},menu:'#jPanelMenu-menu',panel:'.jPanelMenu-panel',fixedChildren:[],timeouts:{},clearTimeouts:function(){clearTimeout(i.timeouts.open);clearTimeout(i.timeouts.afterOpen);clearTimeout(i.timeouts.afterClose)},setPositionUnits:function(){var a=false,allowedUnits=['%','px','em'];for(unitID in allowedUnits){var b=allowedUnits[unitID];if(i.options.openPosition.toString().substr(-b.length)==b){a=true;i.settings.positionUnits=b}}if(!a){i.options.openPosition=parseInt(i.options.openPosition)+i.settings.positionUnits}},checkFixedChildren:function(){i.disableTransitions();var a={position:$(i.panel).css('position')};a[i.options.direction]=($(i.panel).css(i.options.direction)=='auto')?0:$(i.panel).css(i.options.direction);$(i.panel).find('> *').each(function(){if($(this).css('position')=='fixed'&&$(this).css(i.options.direction)=='auto'){i.fixedChildren.push(this)}});if(i.fixedChildren.length>0){var b={position:'relative'};b[i.options.direction]='1px';i.setPanelStyle(b);if(parseInt($(i.fixedChildren[0]).offset().left)==0){i.settings.shiftFixedChildren=true}}i.setPanelStyle(a)},setjPanelMenuStyles:function(){var a='#fff';var b=$('html').css('background-color');var c=$('body').css('background-color');if(c!='transparent'&&c!="rgba(0, 0, 0, 0)"){a=c}else if(b!='transparent'&&b!="rgba(0, 0, 0, 0)"){a=b}else{a='#fff'}if($('#jPanelMenu-style-master').length==0){$('body').append('<style id="jPanelMenu-style-master">body{width:100%}.jPanelMenu,body{overflow-x:hidden}#jPanelMenu-menu{display:block;position:fixed;top:0;'+i.options.direction+':0;height:100%;z-index:-1;overflow-x:hidden;overflow-y:scroll;-webkit-overflow-scrolling:touch}.jPanelMenu-panel{position:static;'+i.options.direction+':0;top:0;z-index:2;width:100%;min-height:100%;background:'+a+'}</style>')}},setMenuState:function(a){var b=(a)?'open':'closed';$('body').attr('data-menu-position',b)},getMenuState:function(){return $('body').attr('data-menu-position')},menuIsOpen:function(){if(i.getMenuState()=='open')return true;else return false},setMenuStyle:function(a){$(i.menu).css(a)},setPanelStyle:function(a){$(i.panel).css(a)},showMenu:function(){i.setMenuStyle({display:'block'});i.setMenuStyle({'z-index':'1'})},hideMenu:function(){i.setMenuStyle({'z-index':'-1'});i.setMenuStyle({display:'none'})},enableTransitions:function(a,b){var c=a/1000;var d=i.getCSSEasingFunction(b);i.disableTransitions();$('body').append('<style id="jPanelMenu-style-transitions">.jPanelMenu-panel{-webkit-transition: all '+c+'s '+d+'; -moz-transition: all '+c+'s '+d+'; -o-transition: all '+c+'s '+d+'; transition: all '+c+'s '+d+';}</style>')},disableTransitions:function(){$('#jPanelMenu-style-transitions').remove()},enableFixedTransitions:function(a,b,c,d){var e=c/1000;var f=i.getCSSEasingFunction(d);i.disableFixedTransitions(b);$('body').append('<style id="jPanelMenu-style-fixed-'+b+'">'+a+'{-webkit-transition: all '+e+'s '+f+'; -moz-transition: all '+e+'s '+f+'; -o-transition: all '+e+'s '+f+'; transition: all '+e+'s '+f+';}</style>')},disableFixedTransitions:function(a){$('#jPanelMenu-style-fixed-'+a).remove()},getCSSEasingFunction:function(a){switch(a){case'linear':return a;break;case'ease':return a;break;case'ease-in':return a;break;case'ease-out':return a;break;case'ease-in-out':return a;break;default:return'ease-in-out';break}},getJSEasingFunction:function(a){switch(a){case'linear':return a;break;default:return'swing';break}},openMenu:function(c){if(typeof(c)=="undefined"||c==null){c=i.options.animated};i.clearTimeouts();i.options.before();i.options.beforeOpen();i.setMenuState(true);i.setPanelStyle({position:'relative'});i.showMenu();var d={none:(!c)?true:false,transitions:(c&&i.settings.transitionsSupported)?true:false};if(d.transitions||d.none){if(d.none)i.disableTransitions();if(d.transitions)i.enableTransitions(i.options.openDuration,i.options.openEasing);var e={};e[i.options.direction]=i.options.openPosition;i.setPanelStyle(e);if(i.settings.shiftFixedChildren){$(i.fixedChildren).each(function(){var a=$(this).prop("tagName").toLowerCase()+' '+$(this).attr('class'),selector=a.replace(' ','.'),a=a.replace(' ','-');if(d.none)i.disableFixedTransitions(a);if(d.transitions)i.enableFixedTransitions(selector,a,i.options.openDuration,i.options.openEasing);var b={};b[i.options.direction]=i.options.openPosition;$(this).css(b)})}i.timeouts.afterOpen=setTimeout(function(){i.disableTransitions();if(i.settings.shiftFixedChildren){$(i.fixedChildren).each(function(){var a=$(this).prop("tagName").toLowerCase()+' '+$(this).attr('class'),a=a.replace(' ','-');i.disableFixedTransitions(a)})}i.options.after();i.options.afterOpen();i.initiateContentClickListeners()},i.options.openDuration)}else{var f=i.getJSEasingFunction(i.options.openEasing);var g={};g[i.options.direction]=i.options.openPosition;$(i.panel).stop().animate(g,i.options.openDuration,f,function(){i.options.after();i.options.afterOpen();i.initiateContentClickListeners()});if(i.settings.shiftFixedChildren){$(i.fixedChildren).each(function(){var a={};a[i.options.direction]=i.options.openPosition;$(this).stop().animate(a,i.options.openDuration,f)})}}},closeMenu:function(c){if(typeof(c)=="undefined"||c==null){c=i.options.animated};i.clearTimeouts();i.options.before();i.options.beforeClose();i.setMenuState(false);var d={none:(!c)?true:false,transitions:(c&&i.settings.transitionsSupported)?true:false};if(d.transitions||d.none){if(d.none)i.disableTransitions();if(d.transitions)i.enableTransitions(i.options.closeDuration,i.options.closeEasing);var e={};e[i.options.direction]=0+i.settings.positionUnits;i.setPanelStyle(e);if(i.settings.shiftFixedChildren){$(i.fixedChildren).each(function(){var a=$(this).prop("tagName").toLowerCase()+' '+$(this).attr('class'),selector=a.replace(' ','.'),a=a.replace(' ','-');if(d.none)i.disableFixedTransitions(a);if(d.transitions)i.enableFixedTransitions(selector,a,i.options.closeDuration,i.options.closeEasing);var b={};b[i.options.direction]=0+i.settings.positionUnits;$(this).css(b)})}i.timeouts.afterClose=setTimeout(function(){i.setPanelStyle({position:i.settings.panelPosition});i.disableTransitions();if(i.settings.shiftFixedChildren){$(i.fixedChildren).each(function(){var a=$(this).prop("tagName").toLowerCase()+' '+$(this).attr('class'),a=a.replace(' ','-');i.disableFixedTransitions(a)})}i.hideMenu();i.options.after();i.options.afterClose();i.destroyContentClickListeners()},i.options.closeDuration)}else{var f=i.getJSEasingFunction(i.options.closeEasing);var g={};g[i.options.direction]=0+i.settings.positionUnits;$(i.panel).stop().animate(g,i.options.closeDuration,f,function(){i.setPanelStyle({position:i.settings.panelPosition});i.hideMenu();i.options.after();i.options.afterClose();i.destroyContentClickListeners()});if(i.settings.shiftFixedChildren){$(i.fixedChildren).each(function(){var a={};a[i.options.direction]=0+i.settings.positionUnits;$(this).stop().animate(a,i.options.closeDuration,f)})}}},triggerMenu:function(a){if(i.menuIsOpen())i.closeMenu(a);else i.openMenu(a)},initiateClickListeners:function(){$(document).on('click',i.options.trigger,function(){i.triggerMenu(i.options.animated);return false})},destroyClickListeners:function(){$(document).off('click',i.options.trigger,null)},initiateContentClickListeners:function(){if(!i.options.closeOnContentClick)return false;$(document).on('click',i.panel,function(e){if(i.menuIsOpen())i.closeMenu(i.options.animated)});$(document).on('touchend',i.panel,function(e){if(i.menuIsOpen())i.closeMenu(i.options.animated)})},destroyContentClickListeners:function(){if(!i.options.closeOnContentClick)return false;$(document).off('click',i.panel,null);$(document).off('touchend',i.panel,null)},initiateKeyboardListeners:function(){var c=['input','textarea'];$(document).on('keydown',function(e){var a=$(e.target),prevent=false;$.each(c,function(){if(a.is(this.toString())){prevent=true}});if(prevent){return true}for(mapping in i.options.keyboardShortcuts){if(e.which==i.options.keyboardShortcuts[mapping].code){var b=i.options.keyboardShortcuts[mapping];if(b.open&&b.close){i.triggerMenu(i.options.animated)}else if((b.open&&!b.close)&&!i.menuIsOpen()){i.openMenu(i.options.animated)}else if((!b.open&&b.close)&&i.menuIsOpen()){i.closeMenu(i.options.animated)}return false}}})},destroyKeyboardListeners:function(){$(document).off('keydown',null)},setupMarkup:function(){$('html').addClass('jPanelMenu');$('body > *').not(i.menu+', '+i.options.excludedPanelContent).wrapAll('<div class="'+i.panel.replace('.','')+'"/>');$(i.options.menu).clone().attr('id',i.menu.replace('#','')).insertAfter('body > '+i.panel)},resetMarkup:function(){$('html').removeClass('jPanelMenu');$('body > '+i.panel+' > *').unwrap();$(i.menu).remove()},init:function(){i.options.beforeOn();i.initiateClickListeners();if(Object.prototype.toString.call(i.options.keyboardShortcuts)==='[object Array]'){i.initiateKeyboardListeners()}i.setjPanelMenuStyles();i.setMenuState(false);i.setupMarkup();i.setMenuStyle({width:i.options.openPosition});i.checkFixedChildren();i.setPositionUnits();i.closeMenu(false);i.options.afterOn()},destroy:function(){i.options.beforeOff();i.closeMenu();i.destroyClickListeners();if(Object.prototype.toString.call(i.options.keyboardShortcuts)==='[object Array]'){i.destroyKeyboardListeners()}i.resetMarkup();var a={};a[i.options.direction]='auto';$(i.fixedChildren).each(function(){$(this).css(a)});i.fixedChildren=[];i.options.afterOff()},setPosition:function(a){if(typeof(a)=="undefined"||a==null){a=i.options.openPosition};i.options.openPosition=a;i.setMenuStyle({width:i.options.openPosition})}};return{on:i.init,off:i.destroy,trigger:i.triggerMenu,open:i.openMenu,close:i.closeMenu,isOpen:i.menuIsOpen,menu:i.menu,getMenu:function(){return $(i.menu)},panel:i.panel,getPanel:function(){return $(i.panel)},position:i.setPosition}}})(jQuery);
